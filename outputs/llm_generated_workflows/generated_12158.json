{
  "template_id": "12158",
  "llm_response": {
    "mode": "create_workflow",
    "workflowPlan": {
      "name": "Inventory Replenishment Automation",
      "nodes": [
        {
          "id": "1",
          "label": "Schedule Trigger",
          "nodeType": "n8n-nodes-base.cron",
          "typeVersion": 1,
          "params": {
            "cronExpression": "0 3 * * *"
          },
          "position": {
            "x": 200,
            "y": 300
          }
        },
        {
          "id": "2",
          "label": "Fetch POS Data",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://pos-api.example.com/data",
            "method": "GET",
            "responseFormat": "json"
          },
          "position": {
            "x": 400,
            "y": 200
          }
        },
        {
          "id": "3",
          "label": "Fetch Historical Sales",
          "nodeType": "n8n-nodes-base.mySql",
          "typeVersion": 1,
          "params": {
            "query": "SELECT * FROM sales_data WHERE date >= CURDATE() - INTERVAL 1 YEAR"
          },
          "position": {
            "x": 400,
            "y": 400
          }
        },
        {
          "id": "4",
          "label": "Fetch Weather Data",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://api.openweathermap.org/data/2.5/forecast",
            "method": "GET",
            "responseFormat": "json",
            "queryParameters": [
              {
                "name": "appid",
                "value": "YOUR_API_KEY"
              },
              {
                "name": "q",
                "value": "CityName"
              }
            ]
          },
          "position": {
            "x": 400,
            "y": 600
          }
        },
        {
          "id": "5",
          "label": "Fetch SNS Trends",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://sns-trend-api.example.com/trends",
            "method": "GET",
            "responseFormat": "json"
          },
          "position": {
            "x": 400,
            "y": 800
          }
        },
        {
          "id": "6",
          "label": "AI Demand Forecasting",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://ai-prediction-api.example.com/forecast",
            "method": "POST",
            "responseFormat": "json",
            "jsonParameters": true,
            "body": {
              "posData": "={{$node[\"Fetch POS Data\"].json}}",
              "historicalSales": "={{$node[\"Fetch Historical Sales\"].json}}",
              "weatherData": "={{$node[\"Fetch Weather Data\"].json}}",
              "snsTrends": "={{$node[\"Fetch SNS Trends\"].json}}"
            }
          },
          "position": {
            "x": 600,
            "y": 500
          }
        },
        {
          "id": "7",
          "label": "Calculate Shortages",
          "nodeType": "n8n-nodes-base.function",
          "typeVersion": 1,
          "params": {
            "functionCode": "const forecast = items[0].json.forecast;\nconst currentStock = items[0].json.currentStock;\nconst safetyStock = items[0].json.safetyStock;\n\nconst shortages = forecast.map(item => {\n  return {\n    productId: item.productId,\n    shortage: Math.max(0, item.forecastedDemand - (currentStock[item.productId] || 0) - (safetyStock[item.productId] || 0))\n  };\n});\n\nreturn [{ json: { shortages } }];"
          },
          "position": {
            "x": 800,
            "y": 500
          }
        },
        {
          "id": "8",
          "label": "Request Supplier Quotes",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://supplier-api.example.com/quotes",
            "method": "POST",
            "responseFormat": "json",
            "jsonParameters": true,
            "body": {
              "shortages": "={{$node[\"Calculate Shortages\"].json.shortages}}"
            }
          },
          "position": {
            "x": 1000,
            "y": 500
          }
        },
        {
          "id": "9",
          "label": "Select Optimal Supplier",
          "nodeType": "n8n-nodes-base.function",
          "typeVersion": 1,
          "params": {
            "functionCode": "const quotes = items[0].json.quotes;\n\nconst optimalSuppliers = quotes.map(item => {\n  const bestSupplier = item.suppliers.reduce((prev, curr) => {\n    return (prev.totalCost < curr.totalCost && prev.leadTime <= 7) ? prev : curr;\n  });\n  return {\n    productId: item.productId,\n    supplier: bestSupplier\n  };\n});\n\nreturn [{ json: { optimalSuppliers } }];"
          },
          "position": {
            "x": 1200,
            "y": 500
          }
        },
        {
          "id": "10",
          "label": "Place Order",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://inventory-api.example.com/order",
            "method": "POST",
            "responseFormat": "json",
            "jsonParameters": true,
            "body": {
              "orders": "={{$node[\"Select Optimal Supplier\"].json.optimalSuppliers}}"
            }
          },
          "position": {
            "x": 1400,
            "y": 500
          }
        },
        {
          "id": "11",
          "label": "Log Order to MySQL",
          "nodeType": "n8n-nodes-base.mySql",
          "typeVersion": 1,
          "params": {
            "query": "INSERT INTO forecast_order_log (product_id, supplier_id, quantity, total_cost, order_date) VALUES (:productId, :supplierId, :quantity, :totalCost, NOW())",
            "additionalFields": {
              "values": "={{$node[\"Select Optimal Supplier\"].json.optimalSuppliers.map(item => ({ productId: item.productId, supplierId: item.supplier.id, quantity: item.supplier.quantity, totalCost: item.supplier.totalCost }))}}"
            }
          },
          "position": {
            "x": 1600,
            "y": 500
          }
        },
        {
          "id": "12",
          "label": "Check AI Confidence",
          "nodeType": "n8n-nodes-base.if",
          "typeVersion": 1,
          "params": {
            "conditions": {
              "number": [
                {
                  "value1": "={{$node[\"AI Demand Forecasting\"].json.confidenceScore}}",
                  "operation": "lessThan",
                  "value2": 0.8
                }
              ]
            }
          },
          "position": {
            "x": 600,
            "y": 700
          }
        },
        {
          "id": "13",
          "label": "Send Slack Alert",
          "nodeType": "n8n-nodes-base.slack",
          "typeVersion": 1,
          "params": {
            "channel": "#inventory-alerts",
            "text": "AI confidence score is low. Manual review required for inventory replenishment."
          },
          "position": {
            "x": 800,
            "y": 700
          }
        }
      ],
      "connections": [
        {
          "from": "1",
          "to": "2"
        },
        {
          "from": "1",
          "to": "3"
        },
        {
          "from": "1",
          "to": "4"
        },
        {
          "from": "1",
          "to": "5"
        },
        {
          "from": "2",
          "to": "6"
        },
        {
          "from": "3",
          "to": "6"
        },
        {
          "from": "4",
          "to": "6"
        },
        {
          "from": "5",
          "to": "6"
        },
        {
          "from": "6",
          "to": "7"
        },
        {
          "from": "7",
          "to": "8"
        },
        {
          "from": "8",
          "to": "9"
        },
        {
          "from": "9",
          "to": "10"
        },
        {
          "from": "10",
          "to": "11"
        },
        {
          "from": "6",
          "to": "12"
        },
        {
          "from": "12",
          "to": "13",
          "outputIndex": 1
        }
      ]
    }
  },
  "usage": {
    "prompt_tokens": 1022,
    "completion_tokens": 2112,
    "total_tokens": 3134
  },
  "error": null,
  "generated_at": "2026-01-11T17:17:29.460079"
}