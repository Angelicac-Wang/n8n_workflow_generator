{
  "template_id": "7664",
  "llm_response": {
    "mode": "create_workflow",
    "workflowPlan": {
      "name": "Telegram Bot with Dynamic Menus & Rating System",
      "nodes": [
        {
          "id": "1",
          "label": "Telegram Webhook Trigger",
          "nodeType": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "params": {
            "path": "telegram-webhook",
            "httpMethod": "POST",
            "responseMode": "onReceived"
          },
          "position": {
            "x": 200,
            "y": 300
          }
        },
        {
          "id": "2",
          "label": "Extract User Data",
          "nodeType": "n8n-nodes-base.function",
          "typeVersion": 1,
          "params": {
            "functionCode": "const userId = items[0].json.message.from.id;\nconst userName = items[0].json.message.from.first_name;\nconst messageType = items[0].json.message.text ? 'text' : 'callback_query';\nreturn [{ json: { userId, userName, messageType } }];"
          },
          "position": {
            "x": 400,
            "y": 300
          }
        },
        {
          "id": "3",
          "label": "Prepare Response",
          "nodeType": "n8n-nodes-base.function",
          "typeVersion": 1,
          "params": {
            "functionCode": "let responseText = '';\nlet keyboard = [];\nswitch (items[0].json.messageType) {\n  case 'text':\n    responseText = `Hello ${items[0].json.userName}, choose an option:`;\n    keyboard = [\n      [{ text: 'Settings', callback_data: 'settings' }],\n      [{ text: 'Profile', callback_data: 'profile' }],\n      [{ text: 'Rate Us', callback_data: 'rate' }]\n    ];\n    break;\n  case 'callback_query':\n    switch (items[0].json.callback_data) {\n      case 'settings':\n        responseText = 'Settings Menu';\n        keyboard = [[{ text: 'Back', callback_data: 'main' }]];\n        break;\n      case 'profile':\n        responseText = 'Profile Menu';\n        keyboard = [[{ text: 'Back', callback_data: 'main' }]];\n        break;\n      case 'rate':\n        responseText = 'Rate us with 1-5 stars:';\n        keyboard = [\n          [{ text: '⭐', callback_data: 'rate_1' }, { text: '⭐⭐', callback_data: 'rate_2' }, { text: '⭐⭐⭐', callback_data: 'rate_3' }, { text: '⭐⭐⭐⭐', callback_data: 'rate_4' }, { text: '⭐⭐⭐⭐⭐', callback_data: 'rate_5' }],\n          [{ text: 'Back', callback_data: 'main' }]\n        ];\n        break;\n      default:\n        responseText = 'Option not recognized.';\n        keyboard = [[{ text: 'Back', callback_data: 'main' }]];\n    }\n    break;\n  default:\n    responseText = 'Unrecognized message type.';\n    keyboard = [[{ text: 'Back', callback_data: 'main' }]];\n}\nreturn [{ json: { responseText, keyboard } }];"
          },
          "position": {
            "x": 600,
            "y": 300
          }
        },
        {
          "id": "4",
          "label": "Send Telegram Message",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/sendMessage",
            "method": "POST",
            "jsonParameters": true,
            "options": {},
            "bodyParametersJson": "={ chat_id: $json[\"userId\"], text: $json[\"responseText\"], reply_markup: { inline_keyboard: $json[\"keyboard\"] } }"
          },
          "position": {
            "x": 800,
            "y": 300
          }
        }
      ],
      "connections": [
        {
          "from": "1",
          "to": "2"
        },
        {
          "from": "2",
          "to": "3"
        },
        {
          "from": "3",
          "to": "4"
        }
      ]
    }
  },
  "usage": {
    "prompt_tokens": 961,
    "completion_tokens": 1025,
    "total_tokens": 1986
  },
  "error": null,
  "generated_at": "2026-01-11T18:32:22.601329"
}