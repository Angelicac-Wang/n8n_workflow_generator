{
  "template_id": "4867",
  "llm_response": {
    "mode": "create_workflow",
    "workflowPlan": {
      "name": "Stock Analysis and Slack Update",
      "nodes": [
        {
          "id": "1",
          "label": "Schedule Trigger",
          "nodeType": "n8n-nodes-base.cron",
          "typeVersion": 1,
          "params": {
            "cronExpression": "0 * * * 1-5",
            "timezone": "America/Los_Angeles"
          },
          "position": {
            "x": 200,
            "y": 300
          }
        },
        {
          "id": "2",
          "label": "Check Market Open",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://paper-api.alpaca.markets/v2/clock",
            "method": "GET",
            "authentication": "oAuth2"
          },
          "position": {
            "x": 400,
            "y": 300
          }
        },
        {
          "id": "3",
          "label": "If Market Open",
          "nodeType": "n8n-nodes-base.if",
          "typeVersion": 1,
          "params": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{$json[\"is_open\"]}}",
                  "operation": "true"
                }
              ]
            }
          },
          "position": {
            "x": 600,
            "y": 300
          }
        },
        {
          "id": "4",
          "label": "Get Stock Data",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://paper-api.alpaca.markets/v2/stocks/bars",
            "method": "GET",
            "authentication": "oAuth2",
            "queryParameters": [
              {
                "name": "symbols",
                "value": "AAPL,GOOGL,AMZN"
              },
              {
                "name": "timeframe",
                "value": "1D"
              }
            ]
          },
          "position": {
            "x": 800,
            "y": 300
          }
        },
        {
          "id": "5",
          "label": "Calculate RSI and MACD",
          "nodeType": "n8n-nodes-base.code",
          "typeVersion": 1,
          "params": {
            "language": "python",
            "code": "import talib\n\n# Assuming input_data is a list of dictionaries with 'close' prices\nclose_prices = [stock['close'] for stock in input_data]\n\nrsi = talib.RSI(close_prices, timeperiod=14)\nmacd, macdsignal, macdhist = talib.MACD(close_prices, fastperiod=12, slowperiod=26, signalperiod=9)\n\n# Categorize stocks\nresults = []\nfor i, stock in enumerate(input_data):\n    if rsi[i] < 30 and macd[i] > macdsignal[i]:\n        category = 'Buy'\n    elif rsi[i] > 70 and macd[i] < macdsignal[i]:\n        category = 'Sell'\n    else:\n        category = 'Hold'\n    results.append({'ticker': stock['symbol'], 'category': category})\n\nreturn results"
          },
          "position": {
            "x": 1000,
            "y": 300
          }
        },
        {
          "id": "6",
          "label": "Summarize with OpenAI",
          "nodeType": "n8n-nodes-base.openai",
          "typeVersion": 1,
          "params": {
            "model": "text-davinci-003",
            "prompt": "Summarize the following stock analysis results in Slack markdown format:\n\n{{JSON.stringify($json)}}",
            "temperature": 0.5
          },
          "position": {
            "x": 1200,
            "y": 300
          }
        },
        {
          "id": "7",
          "label": "Send to Slack",
          "nodeType": "n8n-nodes-base.slack",
          "typeVersion": 1,
          "params": {
            "channel": "#stock-updates",
            "text": "{{$json[\"choices\"][0][\"text\"]}}"
          },
          "position": {
            "x": 1400,
            "y": 300
          }
        }
      ],
      "connections": [
        {
          "from": "1",
          "to": "2"
        },
        {
          "from": "2",
          "to": "3"
        },
        {
          "from": "3",
          "to": "4",
          "outputIndex": 0
        },
        {
          "from": "4",
          "to": "5"
        },
        {
          "from": "5",
          "to": "6"
        },
        {
          "from": "6",
          "to": "7"
        }
      ]
    }
  },
  "usage": {
    "prompt_tokens": 601,
    "completion_tokens": 1142,
    "total_tokens": 1743
  },
  "error": null,
  "generated_at": "2026-01-11T18:13:54.238317"
}