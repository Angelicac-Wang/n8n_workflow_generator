{
  "template_id": "9879",
  "llm_response": {
    "mode": "create_workflow",
    "workflowPlan": {
      "name": "WooCommerce Order Processing and WhatsApp Notification",
      "nodes": [
        {
          "id": "1",
          "label": "WooCommerce Order Trigger",
          "nodeType": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "params": {
            "httpMethod": "POST",
            "path": "woocommerce-order",
            "responseMode": "onReceived",
            "responseData": "default"
          },
          "position": {
            "x": 200,
            "y": 300
          }
        },
        {
          "id": "2",
          "label": "Extract Order Data",
          "nodeType": "n8n-nodes-base.code",
          "typeVersion": 1,
          "params": {
            "functionCode": "return items.map(item => {\n  const order = item.json;\n  return {\n    json: {\n      customerName: order.billing.first_name + ' ' + order.billing.last_name,\n      phoneNumber: order.billing.phone.replace(/\\D/g, ''),\n      email: order.billing.email,\n      address: order.billing.address_1,\n      products: order.line_items.map(product => ({\n        title: product.name,\n        id: product.product_id,\n        quantity: product.quantity,\n        price: product.price\n      })),\n      invoiceLink: order.invoice_link\n    }\n  };\n});"
          },
          "position": {
            "x": 400,
            "y": 300
          }
        },
        {
          "id": "3",
          "label": "Split In Batches",
          "nodeType": "n8n-nodes-base.splitInBatches",
          "typeVersion": 1,
          "params": {
            "batchSize": 10
          },
          "position": {
            "x": 600,
            "y": 300
          }
        },
        {
          "id": "4",
          "label": "Verify WhatsApp Number",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://api.rapiwa.com/verify",
            "method": "POST",
            "authentication": "headerAuth",
            "headerAuth": {
              "name": "Authorization",
              "value": "Bearer YOUR_RAPIWA_TOKEN"
            },
            "bodyParameters": [
              {
                "name": "phone",
                "value": "={{$json[\"phoneNumber\"]}}"
              }
            ]
          },
          "position": {
            "x": 800,
            "y": 200
          }
        },
        {
          "id": "5",
          "label": "IF Verified",
          "nodeType": "n8n-nodes-base.if",
          "typeVersion": 1,
          "params": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{$json[\"verified\"]}}",
                  "value2": true
                }
              ]
            }
          },
          "position": {
            "x": 1000,
            "y": 200
          }
        },
        {
          "id": "6",
          "label": "Send WhatsApp Message",
          "nodeType": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "params": {
            "url": "https://api.rapiwa.com/send-message",
            "method": "POST",
            "authentication": "headerAuth",
            "headerAuth": {
              "name": "Authorization",
              "value": "Bearer YOUR_RAPIWA_TOKEN"
            },
            "bodyParameters": [
              {
                "name": "phone",
                "value": "={{$json[\"phoneNumber\"]}}"
              },
              {
                "name": "message",
                "value": "Hello {{$json[\"customerName\"]}}, your order is confirmed. Invoice: {{$json[\"invoiceLink\"]}}"
              }
            ]
          },
          "position": {
            "x": 1200,
            "y": 100
          }
        },
        {
          "id": "7",
          "label": "Log Verified",
          "nodeType": "n8n-nodes-base.googleSheets",
          "typeVersion": 1,
          "params": {
            "operation": "append",
            "sheetId": "YOUR_GOOGLE_SHEET_ID",
            "range": "Verified!A1",
            "valueInputMode": "USER_ENTERED",
            "data": [
              [
                "={{$json[\"customerName\"]}}",
                "={{$json[\"phoneNumber\"]}}",
                "={{$json[\"email\"]}}",
                "={{$json[\"address\"]}}",
                "={{$json[\"products\"][0][\"title\"]}}",
                "={{$json[\"products\"][0][\"id\"]}}",
                "={{$json[\"products\"][0][\"quantity\"]}}",
                "={{$json[\"products\"][0][\"price\"]}}",
                "={{$json[\"invoiceLink\"]}}",
                "sent",
                "verified"
              ]
            ]
          },
          "position": {
            "x": 1400,
            "y": 100
          }
        },
        {
          "id": "8",
          "label": "Log Unverified",
          "nodeType": "n8n-nodes-base.googleSheets",
          "typeVersion": 1,
          "params": {
            "operation": "append",
            "sheetId": "YOUR_GOOGLE_SHEET_ID",
            "range": "Unverified!A1",
            "valueInputMode": "USER_ENTERED",
            "data": [
              [
                "={{$json[\"customerName\"]}}",
                "={{$json[\"phoneNumber\"]}}",
                "={{$json[\"email\"]}}",
                "={{$json[\"address\"]}}",
                "={{$json[\"products\"][0][\"title\"]}}",
                "={{$json[\"products\"][0][\"id\"]}}",
                "={{$json[\"products\"][0][\"quantity\"]}}",
                "={{$json[\"products\"][0][\"price\"]}}",
                "={{$json[\"invoiceLink\"]}}",
                "not sent",
                "unverified"
              ]
            ]
          },
          "position": {
            "x": 1200,
            "y": 300
          }
        },
        {
          "id": "9",
          "label": "Wait",
          "nodeType": "n8n-nodes-base.wait",
          "typeVersion": 1,
          "params": {
            "waitFor": "1m"
          },
          "position": {
            "x": 600,
            "y": 500
          }
        }
      ],
      "connections": [
        {
          "from": "1",
          "to": "2"
        },
        {
          "from": "2",
          "to": "3"
        },
        {
          "from": "3",
          "to": "4"
        },
        {
          "from": "4",
          "to": "5"
        },
        {
          "from": "5",
          "to": "6",
          "outputIndex": 0
        },
        {
          "from": "5",
          "to": "8",
          "outputIndex": 1
        },
        {
          "from": "6",
          "to": "7"
        },
        {
          "from": "8",
          "to": "9"
        },
        {
          "from": "9",
          "to": "3"
        }
      ]
    }
  },
  "usage": {
    "prompt_tokens": 1466,
    "completion_tokens": 1700,
    "total_tokens": 3166
  },
  "error": null,
  "generated_at": "2026-01-11T18:43:18.499808"
}